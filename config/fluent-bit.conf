[SERVICE]
    Flush        1
    Log_Level    info
    Daemon       off
    Parsers_File parsers.conf

[INPUT]
    Name              tail
    Path              /var/log/crypto-assistant/telegram-bot/*.log
    Parser            json
    Tag               crypto.telegram-bot
    Refresh_Interval  5
    Mem_Buf_Limit     50MB

[INPUT]
    Name              tail
    Path              /var/log/crypto-assistant/market-data/*.log
    Parser            json
    Tag               crypto.market-data
    Refresh_Interval  5
    Mem_Buf_Limit     50MB

[INPUT]
    Name              tail
    Path              /var/log/crypto-assistant/system/*.log
    Parser            json
    Tag               crypto.system
    Refresh_Interval  5
    Mem_Buf_Limit     50MB

[FILTER]
    Name    modify
    Match   crypto.*
    Add     cluster_name crypto-assistant
    Add     log_source fluent-bit

[FILTER]
    Name    grep
    Match   crypto.*
    Regex   level (ERROR|WARN|WARNING|CRITICAL|FATAL)
    
[OUTPUT]
    Name  file
    Match crypto.*
    Path  /var/log/crypto-assistant/aggregated/
    File  crypto-assistant.log
    Format json_lines

[OUTPUT]
    Name  stdout
    Match crypto.*
    Format json_lines